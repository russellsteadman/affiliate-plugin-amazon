<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Affiliate Test Suite</title>
    <script src="/node_modules/affiliate/dist/affiliate.js"></script>
    <script src="/dist/plugin.js"></script>
    <script>
        var setLang = function (window, languages) {
            var prop = { get: function () { return languages; } };
            try {
                Object.defineProperty(window.navigator, 'languages', prop);
            } catch (e) {
                window.navigator = Object.create(navigator, {
                    languages: prop
                });
            }
        };
        setLang(window, ['es-mx', 'pt-BR', 'en-US']);
        var plugin = AffiliatePluginAmazon(Affiliate, {
            tags: {
                us: 't-us',
                gb: 't-gb',
                de: 't-de',
                fr: 't-fr',
                jp: 't-jp',
                ca: 't-ca',
                cn: 't-cn',
                it: 't-it',
                es: 't-es',
                in: 't-in',
                br: 't-br',
                mx: 't-mx'
            },
            debug: true,
            modifyDomain: false,
            locale: 'it'
        });
        plugin.attach();
        window.mutate = function () {
            var mut = document.getElementById("mut");
            var a = document.createElement('a');
            a.setAttribute('href', 'https://amazon.com/test/ref-tag/ref-regex2/?stuff=2#cool');
            a.innerHTML = 'Link';
            mut.appendChild(a);
        };
        window.relink = function () {
            var a = document.getElementById("jp");
            a.setAttribute('href', 'https://www.amazon.co.jp/Honor-6X-Unlocked-Smartphone-Gray/dp/B01MRZFBBH');
        };
    </script>
</head>
<body>
    <h1>AffiliatePluginAmazon Testing</h1>
    <button onclick="mutate();">Mutate</button><br>
    <button onclick="relink();">Change link</button><br>
    <a id="jp" href="https://www.amazon.co.jp/Honor-6X-Unlocked-Smartphone-Gray/dp/B01MRZFBBH">Japan</a><br>
    <a href="https://www.amazon.com/Honor-6X-Unlocked-Smartphone-Gray/dp/B01MRZFBBH">USA</a><br>
    <a href="https://www.amazon.de/Honor-6X-Unlocked-Smartphone-Gray/dp/B01MRZFBBH">Germany</a><br>
    <a href="https://www.amazon.co.uk/Honor-6X-Unlocked-Smartphone-Gray/dp/B01MRZFBBH">UK</a><br>
    <div><div id="mut"></div></div>
</body>
</html>